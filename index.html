<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Who Would Win</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap');
        :root {
            --bg-color: #0c0a09;
            --card-bg-color: #1c1917;
            --border-color: #44403c;
            --text-color: #f3f4f6;
            --text-muted-color: #a8a29e;
            --accent-gorilla: #f59e0b;
            --accent-human: #3b82f6;
            --accent-win: #10B981;
            --accent-loss: #EF4444;
            --accent-mixed: #F97316;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-color); color: var(--text-color); }
        h1, h2, h3, h4, h5, .primary-btn, .toggle-btn { font-family: 'Oswald', sans-serif; text-transform: uppercase; letter-spacing: 0.05em; }
        .section-card { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 0.75rem; margin-bottom: 1.5rem; overflow: hidden; transition: box-shadow 0.3s ease; }
        .section-card:hover { box-shadow: 0 0 25px rgba(0,0,0,0.4); }
        .section-header { cursor: pointer; padding: 1.25rem; display: flex; justify-content: space-between; align-items: center; transition: background-color 0.2s ease-in-out; }
        .section-header:hover { background-color: #292524; }
        .section-content { max-height: 0; overflow: hidden; transition: max-height 0.7s ease-in-out, padding 0.5s ease-in-out; padding: 0 1.25rem; font-family: 'Inter', sans-serif; }
        .section-content.expanded { max-height: 6000px; padding: 1.25rem; padding-top: 0.5rem; }
        .env-card { background-size: cover; background-position: center; position: relative; }
        .env-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(to top, rgba(0,0,0,0.9), rgba(0,0,0,0.2)); border-radius: 0.5rem; }
        .env-card-content { position: relative; z-index: 10; }
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(12, 10, 9, 0.8); backdrop-filter: blur(8px); display: flex; justify-content: center; align-items: center; z-index: 50; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease; }
        .modal-overlay.visible { opacity: 1; visibility: visible; }
        .modal-content { background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 0.75rem; width: 90%; max-width: 650px; max-height: 90vh; overflow-y: auto; transform: scale(0.95); transition: transform 0.3s ease; }
        .modal-overlay.visible .modal-content { transform: scale(1); }
        select { background-color: var(--border-color); border: 1px solid #57534e; }
        .primary-btn { background-color: #1E3A8A; color: white; padding: 0.75rem 1.5rem; border-radius: 0.5rem; font-weight: 700; transition: all 0.2s; border: 1px solid #2563EB; box-shadow: 0 0 15px rgba(59, 130, 246, 0.3); cursor: pointer; }
        .primary-btn:hover { background-color: #2563EB; box-shadow: 0 0 25px rgba(59, 130, 246, 0.5); }
        .toggle-btn { background-color: var(--border-color); color: var(--text-color); padding: 0.5rem 1rem; border-radius: 0.375rem; font-size: 0.875rem; font-weight: 600; }
        .reference-link { color: var(--accent-human); text-decoration: none; transition: color 0.2s; font-weight: 500;}
        .reference-link:hover { color: #60A5FA; text-decoration: underline; }
        .profile-stat-card { background-color: #292524; border-radius: 0.75rem; padding: 1rem; text-align: center; border: 1px solid var(--border-color); }
        .radial-progress { position: relative; width: 100px; height: 100px; border-radius: 50%; background-color: #44403c; margin: 0 auto 0.75rem; }
        .radial-progress svg { position: absolute; top: 0; left: 0; transform: rotate(-90deg); }
        .radial-progress circle { fill: none; stroke-width: 8; }
        .radial-progress .progress-bg { stroke: #44403c; }
        .radial-progress .progress-bar { stroke-linecap: round; transition: stroke-dashoffset 1s ease-out; }
        .radial-progress .progress-value { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-family: 'Oswald', sans-serif; font-size: 1.25rem; }
        .nested-collapsible { background: #292524; border-radius: 0.5rem; margin-top: 1rem; }
        .nested-header { cursor: pointer; padding: 0.75rem 1rem; font-family: 'Oswald', sans-serif; }
        .nested-content { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-out, padding 0.5s ease-out; padding: 0 1rem; color: var(--text-muted-color); font-size: 0.875rem; line-height: 1.6; }
        .nested-content.expanded { max-height: 1000px; padding: 1rem; padding-top: 0; }
        #audio-player {
            background-color: var(--card-bg-color);
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border-color);
        }
        .audio-btn { background: none; border: none; color: var(--text-muted-color); cursor: pointer; transition: color 0.2s; }
        .audio-btn:hover { color: var(--text-color); }
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-runnable-track { height: 4px; background: #44403c; border-radius: 2px; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%; background: var(--accent-human); cursor: pointer; margin-top: -6px; }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">

    <!-- Audio Player -->
    <div id="audio-player">
        <button id="play-pause-btn" class="audio-btn"></button>
        <i data-lucide="volume-1" class="text-gray-500"></i>
        <input type="range" id="volume-slider" min="-40" max="0" value="-10" class="w-24">
        <i data-lucide="volume-2" class="text-gray-500"></i>
    </div>

    <div class="max-w-5xl mx-auto mt-24">
        <header class="text-center mb-10">
            <h1 class="text-4xl sm:text-6xl font-bold text-white mb-2">Who Would Win?</h1>
            <p class="text-xl text-gray-400 font-sans tracking-wide normal-case">One Gorilla, Hundred Men. Only One Possible Winner.</p>
        </header>

        <!-- Scenario Builder -->
        <div class="section-card" id="scenario-builder">
             <div class="p-6">
                <h2 class="text-2xl font-bold mb-4 text-center">Create Your Scenario</h2>
                <div class="grid sm:grid-cols-3 gap-4 mb-6 font-sans">
                    <div><label for="gorilla-state" class="block mb-2 text-sm font-medium text-gray-300 normal-case">Gorilla's State</label><select id="gorilla-state" class="w-full p-2.5 rounded-lg text-white"><option value="normal">Normal / Defensive</option><option value="bloodlusted">Bloodlusted / Max Aggression</option></select></div>
                    <div><label for="human-state" class="block mb-2 text-sm font-medium text-gray-300 normal-case">Humans' State</label><select id="human-state" class="w-full p-2.5 rounded-lg text-white"><option value="fearful">Fearful / Panicked</option><option value="unco-bloodlusted">Uncoordinated & Bloodlusted</option><option value="co-bloodlusted">Coordinated & Bloodlusted</option></select></div>
                    <div><label for="environment" class="block mb-2 text-sm font-medium text-gray-300 normal-case">Environment</label><select id="environment" class="w-full p-2.5 rounded-lg text-white"><option value="open">Open Plain / Arena</option><option value="forest">Dense Forest / Ruins</option><option value="confined">Confined Arena (No Escape)</option></select></div>
                </div>
                <div class="text-center"><button class="primary-btn" onclick="showScenario()">Analyze Outcome</button></div>
            </div>
        </div>
        
        <!-- Tale of the Tape -->
        <div class="section-card" id="export-profiles">
            <div class="section-header" onclick="toggleSection(this)">
                <div class="flex items-center gap-4"><i data-lucide="swords"></i><h2 class="text-xl font-semibold">Tale of the Tape</h2></div>
                <button class="toggle-btn">Learn More</button>
            </div>
            <div class="section-content border-t border-gray-700">
                <div class="pt-4 grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Gorilla Profile -->
                    <div class="space-y-4">
                        <h3 class="text-2xl font-bold text-center" style="color: var(--accent-gorilla);">Silverback Gorilla</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">STRENGTH</h4><div class="radial-progress" data-value="95"></div><p class="text-xs text-gray-400">~815 kg Lift</p></div>
                            <div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">WEAPONRY</h4><div class="radial-progress" data-value="90"></div><p class="text-xs text-gray-400">1,300 PSI Bite</p></div>
                            <div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">DURABILITY</h4><div class="radial-progress" data-value="85"></div><p class="text-xs text-gray-400">Robust Skeleton</p></div>
                            <div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">SPEED</h4><div class="radial-progress" data-value="75"></div><p class="text-xs text-gray-400">~40 km/h Sprint</p></div>
                        </div>
                        <div class="nested-collapsible"><div class="nested-header" onclick="toggleNested(event)">Physical Prowess +</div><div class="nested-content"><p>Lifting capacity up to 815 kg. Punching force of 1,000-1,200 lbf, capable of catastrophic damage. Capable of short sprints up to 40 km/h and are efficient climbers. Predominantly fast-twitch muscle for explosive power, not prolonged endurance.</p></div></div>
                        <div class="nested-collapsible"><div class="nested-header" onclick="toggleNested(event)">Natural Weaponry +</div><div class="nested-content"><p>Primary weapons are immense strength for tearing/bludgeoning and a powerful bite (~1,300 PSI). In combat, they use powerful charges and direct physical assault. 99% of charges are bluffs in normal circumstances, but in a life-or-death fight, all attacks are committed.</p></div></div>
                    </div>
                    <!-- Human Profile -->
                    <div class="space-y-4">
                        <h3 class="text-2xl font-bold text-center" style="color: var(--accent-human);">100 Unarmed Men</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">STRENGTH</h4><div class="radial-progress" data-value="10" data-color="var(--accent-human)"></div><p class="text-xs text-gray-400">Combined Mass</p></div>
                            <div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">WEAPONRY</h4><div class="radial-progress" data-value="5" data-color="var(--accent-human)"></div><p class="text-xs text-gray-400">None</p></div>
                            <div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">DURABILITY</h4><div class="radial-progress" data-value="15" data-color="var(--accent-human)"></div><p class="text-xs text-gray-400">Biologically Fragile</p></div>
                            <div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">ADVANTAGE</h4><div class="radial-progress" data-value="80" data-color="var(--accent-human)"></div><p class="text-xs text-gray-400">Endurance</p></div>
                        </div>
                        <div class="nested-collapsible"><div class="nested-header" onclick="toggleNested(event)">Physicality & Psychology +</div><div class="nested-content"><p>Individually outmatched in every metric. Success relies on coordinated numbers, not individual power. Biologically fragile. A key advantage is superior endurance for prolonged fights. The psychological state is the paramount determinant: fear leads to disarray, while bloodlust or extreme resolve could enable a unified swarm attack.</p></div></div>
                        <div class="nested-collapsible"><div class="nested-header" onclick="toggleNested(event)">Unarmed Disadvantage +</div><div class="nested-content"><p>Humans' evolutionary success is tied to tools. Unarmed, their offensive capability is limited to blunt force and high-risk grappling. This necessitates swarm tactics where individuals must accept catastrophic risk to create openings for the group. Victory is predicated on overwhelming the gorilla with sheer mass.</p></div></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Battlefield Section -->
        <div class="section-card" id="export-environments">
            <div class="section-header" onclick="toggleSection(this)">
                <div class="flex items-center gap-4"><i data-lucide="map"></i><h2 class="text-xl font-semibold">The Battlefield</h2></div><button class="toggle-btn">Learn More</button>
            </div>
            <div class="section-content border-t border-gray-700">
                <div class="grid md:grid-cols-3 gap-4 pt-4 md:items-start">
                    <!-- Open Plain -->
                    <div class="p-4 rounded-lg env-card border border-gray-700 flex flex-col justify-between min-h-[14rem]" style="background-image: url(https://images.unsplash.com/photo-1444858345149-8ff44d14b434?q=80&w=2070&auto=format&fit=crop);">
                        <div class="env-card-content">
                            <h4 class="font-bold text-lg mb-2">Open Plain</h4>
                            <p class="text-xs text-gray-300 mb-2"><strong><span style="color: var(--accent-human);">Favors Humans</span> (if coordinated):</strong> Allows for encirclement.</p>
                        </div> 
                        <div class="nested-collapsible mt-0 relative z-10"><div class="nested-header" onclick="toggleNested(event)">Details +</div><div class="nested-content"><p><strong>Gorilla's Play:</strong> Can use full charging speed. However, it is vulnerable to being surrounded with no cover to retreat to.<br><strong>Humans' Play:</strong> Swarm tactics are most effective here. Clear lines of sight facilitate coordination. However, individuals are highly exposed.</p></div></div>
                    </div>
                    <!-- Dense Forest -->
                    <div class="p-4 rounded-lg env-card border border-gray-700 flex flex-col justify-between min-h-[14rem]" style="background-image: url(https://images.unsplash.com/photo-1543166332-a5354e3a479b?q=80&w=1974&auto=format&fit=crop);">
                        <div class="env-card-content">
                            <h4 class="font-bold text-lg mb-2">Dense Forest</h4>
                            <p class="text-xs text-gray-300 mb-2"><strong><span style="color: var(--accent-gorilla);">Favors Gorilla:</span></strong> Utilizes ambush and cover.</p>
                        </div>
                        <div class="nested-collapsible mt-0 relative z-10"><div class="nested-header" onclick="toggleNested(event)">Details +</div><div class="nested-content"><p><strong>Gorilla's Play:</strong> Uses climbing and cover to break up formations and launch surprise attacks. Can negate human numbers by forcing smaller, sequential fights.<br><strong>Humans' Play:</strong> Coordination breaks down. High risk of ambush. Numerical advantage is largely nullified.</p></div></div>
                    </div>
                    <!-- Confined Arena -->
                    <div class="p-4 rounded-lg env-card border border-gray-700 flex flex-col justify-between min-h-[14rem]" style="background-image: url(https://images.unsplash.com/photo-1593994399952-32087965a6f3?q=80&w=1931&auto=format&fit=crop);">
                        <div class="env-card-content">
                            <h4 class="font-bold text-lg mb-2">Confined Arena</h4>
                            <p class="text-xs text-gray-300 mb-2"><strong><span style="color: var(--accent-mixed);">Forces Confrontation:</span></strong> A brutal battle of attrition.</p>
                        </div>
                        <div class="nested-collapsible mt-0 relative z-10"><div class="nested-header" onclick="toggleNested(event)">Details +</div><div class="nested-content"><p><strong>Gorilla's Play:</strong> No retreat. May become hyper-aggressive when cornered. Cannot use mobility to escape the swarm.<br><strong>Humans' Play:</strong> Encirclement is inevitable. The inability to flee may heighten resolve or induce panic. A pure test of numbers vs. power.</p></div></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Appendix Section -->
        <div class="section-card" id="export-appendix">
            <div class="section-header" onclick="toggleSection(this)">
                <div class="flex items-center gap-4"><i data-lucide="paw-print"></i><h2 class="text-xl font-semibold">Comparative Threats</h2></div><button class="toggle-btn">Learn More</button>
            </div>
            <div class="section-content border-t border-gray-700 space-y-8">
                <!-- Elephant -->
                <div class="pt-4"><h3 class="text-xl font-bold text-center text-gray-300">African Elephant</h3><div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4"> <div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">POWER</h4><div class="radial-progress" data-value="100" data-color="#a8a29e"></div><p class="text-xs text-gray-400">~6 Tons</p></div><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">WEAPONRY</h4><div class="radial-progress" data-value="100" data-color="#a8a29e"></div><p class="text-xs text-gray-400">Tusks/Trample</p></div><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">DEFENSE</h4><div class="radial-progress" data-value="100" data-color="#a8a29e"></div><p class="text-xs text-gray-400">Thick Hide</p></div><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">THREAT</h4><div class="radial-progress" data-value="100" data-color="#a8a29e"></div><p class="text-xs text-gray-400">Insurmountable</p></div></div><div class="font-sans mt-4"><label class="text-sm font-medium text-gray-300">Human State:</label><select id="human-state-elephant" class="w-full mt-1 p-2.5 rounded-lg text-white" onchange="showAppendixScenario('elephant')"><option value="fearful">Fearful / Panicked</option><option value="unco-bloodlusted">Uncoordinated & Bloodlusted</option><option value="co-bloodlusted">Coordinated & Bloodlusted</option></select><div id="result-elephant" class="mt-2 text-sm"></div></div></div>
                <!-- Grizzly -->
                <div><h3 class="text-xl font-bold text-center text-gray-300">Grizzly Bear</h3><div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4"><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">POWER</h4><div class="radial-progress" data-value="98" data-color="#a8a29e"></div><p class="text-xs text-gray-400">~360 kg</p></div><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">WEAPONRY</h4><div class="radial-progress" data-value="98" data-color="#a8a29e"></div><p class="text-xs text-gray-400">Claws/Bite</p></div><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">DURABILITY</h4><div class="radial-progress" data-value="95" data-color="#a8a29e"></div><p class="text-xs text-gray-400">Muscle/Bone</p></div><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">THREAT</h4><div class="radial-progress" data-value="99" data-color="#a8a29e"></div><p class="text-xs text-gray-400">Overwhelming</p></div></div><div class="font-sans mt-4"><label class="text-sm font-medium text-gray-300">Human State:</label><select id="human-state-grizzly" class="w-full mt-1 p-2.5 rounded-lg text-white" onchange="showAppendixScenario('grizzly')"><option value="fearful">Fearful / Panicked</option><option value="unco-bloodlusted">Uncoordinated & Bloodlusted</option><option value="co-bloodlusted">Coordinated & Bloodlusted</option></select><div id="result-grizzly" class="mt-2 text-sm"></div></div></div>
                <!-- Tiger -->
                <div><h3 class="text-xl font-bold text-center text-gray-300">Siberian Tiger</h3><div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4"><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">POWER</h4><div class="radial-progress" data-value="80" data-color="#a8a29e"></div><p class="text-xs text-gray-400">~300 kg</p></div><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">WEAPONRY</h4><div class="radial-progress" data-value="95" data-color="#a8a29e"></div><p class="text-xs text-gray-400">Apex Predator</p></div><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">AGILITY</h4><div class="radial-progress" data-value="90" data-color="#a8a29e"></div><p class="text-xs text-gray-400">Lethal Speed</p></div><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">THREAT</h4><div class="radial-progress" data-value="70" data-color="#a8a29e"></div><p class="text-xs text-gray-400">Can be Swarmed</p></div></div><div class="font-sans mt-4"><label class="text-sm font-medium text-gray-300">Human State:</label><select id="human-state-tiger" class="w-full mt-1 p-2.5 rounded-lg text-white" onchange="showAppendixScenario('tiger')"><option value="fearful">Fearful / Panicked</option><option value="unco-bloodlusted">Uncoordinated & Bloodlusted</option><option value="co-bloodlusted">Coordinated & Bloodlusted</option></select><div id="result-tiger" class="mt-2 text-sm"></div></div></div>
                <!-- Moose -->
                <div><h3 class="text-xl font-bold text-center text-gray-300">Bull Moose</h3><div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4"><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">POWER</h4><div class="radial-progress" data-value="75" data-color="#a8a29e"></div><p class="text-xs text-gray-400">~700 kg</p></div><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">WEAPONRY</h4><div class="radial-progress" data-value="60" data-color="#a8a29e"></div><p class="text-xs text-gray-400">Antlers/Hooves</p></div><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">AGGRESSION</h4><div class="radial-progress" data-value="40" data-color="#a8a29e"></div><p class="text-xs text-gray-400">Mainly Defensive</p></div><div class="profile-stat-card"><h4 class="font-semibold text-sm mb-2">THREAT</h4><div class="radial-progress" data-value="50" data-color="#a8a29e"></div><p class="text-xs text-gray-400">Can be Swarmed</p></div></div><div class="font-sans mt-4"><label class="text-sm font-medium text-gray-300">Human State:</label><select id="human-state-moose" class="w-full mt-1 p-2.5 rounded-lg text-white" onchange="showAppendixScenario('moose')"><option value="fearful">Fearful / Panicked</option><option value="unco-bloodlusted">Uncoordinated & Bloodlusted</option><option value="co-bloodlusted">Coordinated & Bloodlusted</option></select><div id="result-moose" class="mt-2 text-sm"></div></div></div>
            </div>
        </div>

        <!-- References Section -->
        <div class="section-card" id="export-references">
            <div class="section-header" onclick="toggleSection(this)">
                <div class="flex items-center gap-4"><i data-lucide="scroll-text"></i><h2 class="text-xl font-semibold">Sources</h2></div><button class="toggle-btn">Learn More</button>
            </div>
            <div class="section-content border-t border-gray-700 text-xs text-gray-400 space-y-4 pt-4">
                <div><h4 class="font-semibold text-gray-200 mb-1">Physiology & Combat</h4><p>[3] Roach, N. T., et al. (2013). <a href="https://www.nature.com/articles/nature12138" target="_blank" class="reference-link">Elastic energy storage...</a><br>[4] Nat Geo. <a href="https://www.nationalgeographic.com/animals/mammals/facts/mountain-gorilla" target="_blank" class="reference-link">Gorilla Facts.</a><br>[5] P. W. Lucas, et al. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3311815/" target="_blank" class="reference-link">Primate Gape, Bite Force...</a><br>[8] Live Science. <a href="https://www.livescience.com/53875-gorilla-facts.html" target="_blank" class="reference-link">Gorilla vs Human.</a><br>[9] C. Owen Lovejoy, et al. <a href="https://www.pnas.org/doi/10.1073/pnas.0906114106" target="_blank" class="reference-link">The Great Divides:...Skeletal Structure.</a><br>[16] CDC. <a href="https://www.cdc.gov/nchs/fastats/body-measurements.htm" target="_blank" class="reference-link">Anthropometric Data.</a><br>[17] A. N. Netto, et al. <a href="https://pubmed.ncbi.nlm.nih.gov/28582299/" target="_blank" class="reference-link">Punching Power.</a></p></div>
                <div><h4 class="font-semibold text-gray-200 mb-1">Behavior & Psychology</h4><p>[10] G. B. Schaller (1963). <a href="https://press.uchicago.edu/ucp/books/book/chicago/M/bo3630262.html" target="_blank" class="reference-link">The Mountain Gorilla.</a><br>[11] D. Fossey (1983). <a href="https://www.google.com/books/edition/Gorillas_in_the_Mist/gYq0DwAAQBAJ" target="_blank" class="reference-link">Gorillas in the Mist.</a><br>[12] Kogan, N., & Wallach, M. A. <a href="https://psycnet.apa.org/record/1968-07505-001" target="_blank" class="reference-link">Risk Taking... in the group.</a><br>[18] Merriam-Webster. <a href="https://www.merriam-webster.com/dictionary/bloodlust" target="_blank" class="reference-link">Definition of 'bloodlust'.</a><br>[20] Elbert, T., et al. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2784157/" target="_blank" class="reference-link">Appetitive aggression...</a></p></div>
                <div><h4 class="font-semibold text-gray-200 mb-1">Tactics & Environment</h4><p>[23] Bramble & Lieberman. <a href="https://www.nature.com/articles/nature03052" target="_blank" class="reference-link">Endurance running...</a><br>[25] US Army. <a href="https://armypubs.army.mil/epubs/DR_pubs/DR_a/pdf/web/ARN18126_ADP%203-90%20FINAL%20WEB.pdf" target="_blank" class="reference-link">ADP 3-90: Offense and Defense.</a><br>[26] RAND Corp. <a href="https://www.rand.org/topics/asymmetric-warfare.html" target="_blank" class="reference-link">Asymmetric Warfare.</a></p></div>
                <div><h4 class="font-semibold text-gray-200 mb-1">Comparative Zoology</h4><p>[28] <a href="https://www.awf.org/wildlife-conservation" target="_blank" class="reference-link">African Wildlife Foundation.</a><br>[29] <a href="https://animaldiversity.org/" target="_blank" class="reference-link">Animal Diversity Web.</a></p></div>
            </div>
        </div>
        <footer class="text-center mt-12 text-gray-500 text-sm font-sans normal-case tracking-normal"><p>This analysis is a speculative exercise. No gorillas were harmed in its creation.</p></footer>
    </div>
    <!-- Modal -->
    <div id="modal-overlay" class="modal-overlay"><div id="modal-content" class="modal-content"></div></div>
    <script>
        lucide.createIcons();

        // --- AUDIO PLAYER LOGIC ---
        const playPauseBtn = document.getElementById('play-pause-btn');
        const volumeSlider = document.getElementById('volume-slider');
        let playerReady = false;
        let isPlaying = false;
        
        const reverb = new Tone.Reverb({ decay: 4, preDelay: 0.01 }).toDestination();
        const synth = new Tone.PolySynth(Tone.Synth, {
            oscillator: { type: 'triangle8' },
            envelope: { attack: 0.05, decay: 0.1, sustain: 0.3, release: 1 },
        }).connect(reverb);
        
        const melody = [
            { time: '0:0', note: 'B4', duration: '8n' }, { time: '0:1', note: 'A4', duration: '8n' },
            { time: '0:2', note: 'B4', duration: '4n' }, { time: '0:3', note: 'E4', duration: '8n' },
            { time: '0:3:2', note: 'G4', duration: '8n' }, { time: '1:0', note: 'B4', duration: '8n' },
            { time: '1:1', note: 'A4', duration: '8n' }, { time: '1:2', note: 'B4', duration: '4n' },
            { time: '1:3', note: 'E4', duration: '8n' }, { time: '1:3:2', note: 'G4', duration: '8n' },
            { time: '2:0', note: 'B4', duration: '8n' }, { time: '2:1', note: 'A4', duration: '8n' },
            { time: '2:2', note: 'B4', duration: '4n' }, { time: '2:3', note: 'C5', duration: '8n' },
            { time: '2:3:2', note: 'B4', duration: '8n' }, { time: '3:0', note: 'A4', duration: '2n' },
            { time: '3:2', note: 'G4', duration: '2n' }, { time: '4:0', note: 'E5', duration: '2n' },
            { time: '4:2', note: 'B4', duration: '2n.' }, { time: '5:1', note: 'A4', duration: '8n' },
            { time: '5:2', note: 'B4', duration: '4n' }, { time: '5:3', note: 'E4', duration: '8n' },
            { time: '5:3:2', note: 'G4', duration: '8n' }, { time: '6:0', note: 'B4', duration: '8n' },
            { time: '6:1', note: 'A4', duration: '8n' }, { time: '6:2', note: 'B4', duration: '4n' },
            { time: '6:3', note: 'E4', duration: '8n' }, { time: '6:3:2', note: 'G4', duration: '8n' },
            { time: '7:0', note: 'B4', duration: '8n' }, { time: '7:1', note: 'A4', duration: '8n' },
            { time: '7:2', note: 'B4', duration: '4n' }, { time: '7:3', note: 'C5', duration: '8n' },
            { time: '7:3:2', note: 'B4', duration: '8n' }, { time: '8:0', note: 'A4', duration: '2n' },
            { time: '8:2', note: 'D5', duration: '2n' }, { time: '9:0', note: 'C5', duration: '1n' }
        ];

        const melodyPart = new Tone.Part(function(time, value) {
            synth.triggerAttackRelease(value.note, value.duration, time);
        }, melody).start(0);
        melodyPart.loop = true;
        melodyPart.loopEnd = '10m';
        Tone.Transport.bpm.value = 100;

        function updatePlayButton() {
            playPauseBtn.innerHTML = isPlaying ? '<i data-lucide="pause"></i>' : '<i data-lucide="play"></i>';
            lucide.createIcons({ nodes: playPauseBtn.querySelectorAll("[data-lucide]") });
        }

        playPauseBtn.addEventListener('click', async () => {
            if (Tone.context.state !== 'running') {
                await Tone.start();
            }
            if (Tone.Transport.state === 'started') {
                Tone.Transport.pause();
                isPlaying = false;
            } else {
                Tone.Transport.start();
                isPlaying = true;
            }
            updatePlayButton();
        });

        volumeSlider.addEventListener('input', (e) => {
            Tone.Destination.volume.value = e.target.value;
        });

        document.addEventListener('DOMContentLoaded', () => {
            Tone.Destination.volume.value = volumeSlider.value;
            updatePlayButton();
        });


        // --- UI TOGGLE LOGIC ---
        function toggleSection(headerElement) {
            const content = headerElement.nextElementSibling;
            const button = headerElement.querySelector('.toggle-btn');
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                button.textContent = 'Learn More';
            } else {
                content.classList.add('expanded');
                button.textContent = 'Collapse';
                const progressBars = content.querySelectorAll('.radial-progress');
                progressBars.forEach(bar => setupRadialProgress(bar));
                if (headerElement.parentElement.id === 'export-appendix') {
                    showAppendixScenario('elephant');
                    showAppendixScenario('grizzly');
                    showAppendixScenario('tiger');
                    showAppendixScenario('moose');
                }
            }
        }

        function toggleNested(event) {
            event.stopPropagation();
            const headerElement = event.currentTarget;
            const content = headerElement.nextElementSibling;
            content.classList.toggle('expanded');
        }

        function setupRadialProgress(el) {
            const value = parseInt(el.dataset.value);
            const color = el.dataset.color || 'var(--accent-gorilla)';
            const radius = 40;
            const circumference = 2 * Math.PI * radius;
            const offset = circumference - (value / 100) * circumference;
            const html = `<svg width="100" height="100" viewBox="0 0 100 100"><circle class="progress-bg" cx="50" cy="50" r="${radius}"></circle><circle class="progress-bar" cx="50" cy="50" r="${radius}" stroke="${color}" stroke-dasharray="${circumference}" stroke-dashoffset="${circumference}"></circle></svg><div class="progress-value" style="color: ${color}">${value}</div>`;
            el.innerHTML = html;
            setTimeout(() => { el.querySelector('.progress-bar').style.strokeDashoffset = offset; }, 100);
        }
        
        // --- SCENARIO LOGIC ---
        const scenarioDB = {
            gorilla: {
                normal: {
                    fearful: { open: { title: "Gorilla Victory", analysis: "The gorilla's initial threat displays cause mass panic. The human group scatters, cohesion breaks instantly, and they become ineffective." }, forest: { title: "Decisive Gorilla Victory", analysis: "The gorilla uses the terrain for ambush and intimidation. Fearful humans in a disorienting environment stand no chance." }, confined: { title: "Gorilla Victory", analysis: "No escape route amplifies human panic. The gorilla, feeling cornered, becomes highly aggressive. The panicked mob is easily dismantled." } },
                    "unco-bloodlusted": { open: { title: "Decisive Gorilla Victory", analysis: "Bloodlust without coordination is suicidal. Sporadic, reckless charges are easily dealt with sequentially by the gorilla." }, forest: { title: "Decisive Gorilla Victory", analysis: "The worst-case scenario for humans. The gorilla's environmental advantage combined with a lack of human strategy leads to a massacre." }, confined: { title: "Decisive Gorilla Victory", analysis: "Even in a confined space, uncoordinated attacks are futile. The gorilla systematically destroys attackers." } },
                    "co-bloodlusted": { open: { title: "Costly Human Victory", analysis: "This is the humans' best chance. Suppressed fear allows a coordinated swarm. Casualties will be catastrophic, but sustained numbers could eventually win." }, forest: { title: "Gorilla Favored / Pyrrhic Victory", analysis: "The gorilla's ability to ambush severely hampers coordination. Humans might eventually win, but the cost would be immense." }, confined: { title: "Costly Human Victory", analysis: "A brutal battle of attrition. If human resolve holds, their numbers will inevitably overwhelm the gorilla. Expect dozens of fatalities." } }
                },
                bloodlusted: {
                    fearful: { open: { title: "Annihilation", analysis: "A maximally aggressive gorilla against a terrified crowd is not a fight; it's a slaughter." }, forest: { title: "Annihilation", analysis: "The gorilla becomes a terrifying, unstoppable force in its own element. Humans have no hope of escape or defense." }, confined: { title: "Annihilation", analysis: "A bloodbath. The humans are trapped with a relentless killing machine. The outcome is swift and total." } },
                    "unco-bloodlusted": { open: { title: "Decisive Gorilla Victory", analysis: "A bloodlusted gorilla maximizes its kill rate. Uncoordinated attacks are even more futile, resulting in a swift, brutal defeat." }, forest: { title: "Decisive Gorilla Victory", analysis: "The gorilla hunts down the uncoordinated attackers with extreme prejudice. Human aggression is meaningless without strategy." }, confined: { title: "Decisive Gorilla Victory", analysis: "The arena becomes a killing floor. The gorilla's sustained ferocity completely overwhelms the chaotic human assault." } },
                    "co-bloodlusted": { open: { title: "Mutual Destruction", analysis: "The ultimate clash. The gorilla's attack will cause staggering casualties. Humans might win, but the cost could be over half the group." }, forest: { title: "Gorilla Victory", analysis: "A bloodlusted gorilla in a forest is nearly unbeatable. It will use terrain to inflict maximum damage while avoiding encirclement." }, confined: { title: "Costly Human Victory (Extreme)", analysis: "The most brutal scenario. The gorilla fights to the absolute death. Humans can only win by literally piling bodies on it." } }
                }
            },
            appendix: {
                elephant: { fearful: { title: "Total Annihilation (Elephant Win)", color: "var(--accent-loss)", analysis: "Not a contest. The elephant's presence alone induces terror. Any who don't flee are trampled or gored. Zero chance for humans." }, "unco-bloodlusted": { title: "Total Annihilation (Elephant Win)", color: "var(--accent-loss)", analysis: "Individual acts of 'bravery' are meaningless. Uncoordinated humans are effortlessly dispatched. The elephant is never threatened." }, "co-bloodlusted": { title: "Total Annihilation (Elephant Win)", color: "var(--accent-loss)", analysis: "Coordination is irrelevant. Humans lack any means to harm the elephant. Their mass is insufficient to restrain it. A unified charge just results in a unified death." } },
                grizzly: { fearful: { title: "Total Annihilation (Grizzly Win)", color: "var(--accent-loss)", analysis: "The bear's roar and charge would break any group of unarmed men. The result is a one-sided slaughter of those who don't escape fast enough." }, "unco-bloodlusted": { title: "Total Annihilation (Grizzly Win)", color: "var(--accent-loss)", analysis: "Reckless charges are met with devastating swipes and bites. The grizzly's kill rate would be extraordinarily high. A futile effort." }, "co-bloodlusted": { title: "Overwhelming Grizzly Victory", color: "var(--accent-loss)", analysis: "Even a coordinated swarm is unlikely to succeed. The bear's claws, bite, and raw power would inflict catastrophic casualties before the humans could apply enough mass to matter. The bear wins." } },
                tiger: { fearful: { title: "Decisive Tiger Victory", color: "var(--accent-loss)", analysis: "The tiger's speed and predatory instinct would allow it to kill several panicked humans before the rest scatter completely. A terrifying rout." }, "unco-bloodlusted": { title: "Decisive Tiger Victory", color: "var(--accent-loss)", analysis: "The tiger can easily dodge and counter individual attacks, picking off humans one by one. The lack of coordination is fatal." }, "co-bloodlusted": { title: "Costly Human Victory", color: "var(--accent-win)", analysis: "This is winnable for the humans, but at a terrible price. The tiger will kill many in the initial swarm, but it lacks the sheer bulk to resist being overwhelmed and smothered by 50+ determined men." } },
                moose: { fearful: { title: "Moose Victory", color: "var(--accent-loss)", analysis: "A charging bull moose is terrifying. Panicked humans would scatter, and the moose would likely trample several before disengaging. It wins by routing the threat." }, "unco-bloodlusted": { title: "Pyrrhic Human Victory", color: "var(--accent-mixed)", analysis: "Uncoordinated humans will suffer casualties from kicks and charges, but the moose lacks the offensive drive of a predator. It will eventually be brought down by sheer numbers." }, "co-bloodlusted": { title: "Decisive Human Victory", color: "var(--accent-win)", analysis: "A coordinated swarm can easily avoid the moose's main weapons (antlers/charge) and attack from the sides and rear. It will be overwhelmed and brought down with moderate difficulty and few casualties." } }
            }
        };

        // --- MODAL AND EXPORT LOGIC ---
        function showScenario() {
            const gorillaState = document.getElementById('gorilla-state').value;
            const humanState = document.getElementById('human-state').value;
            const environment = document.getElementById('environment').value;
            const result = scenarioDB.gorilla[gorillaState][humanState][environment];
            
            // Determine color based on title
            let color = 'var(--accent-mixed)';
            if (result.title.toLowerCase().includes('human victory')) color = 'var(--accent-win)';
            if (result.title.toLowerCase().includes('gorilla victory') || result.title.toLowerCase().includes('annihilation')) color = 'var(--accent-loss)';

            const modalContent = document.getElementById('modal-content');
            modalContent.innerHTML = `<div id="capture-scenario"><div class="p-6"><div class="flex justify-between items-start"><h3 class="text-2xl font-bold mb-4">Scenario Outcome</h3><button onclick="closeModal()" class="text-gray-400 hover:text-white text-3xl leading-none">&times;</button></div><div class="mb-4 p-4 rounded-lg border" style="border-color:${color};background-color:${color}20;"><h4 class="text-xl font-bold" style="color:${color};">${result.title}</h4></div><div class="space-y-4 text-gray-300 font-sans tracking-normal normal-case"><div><h5 class="font-semibold text-white mb-1 font-family-oswald uppercase">Analysis:</h5><p class="text-sm">${result.analysis}</p></div><div><h5 class="font-semibold text-white mb-1 font-family-oswald uppercase">Key Factors:</h5><ul class="list-disc list-inside text-sm space-y-1"><li>Gorilla State: <span class="font-medium">${gorillaState.replace("-", " ")}</span></li><li>Human State: <span class="font-medium">${humanState.replace("-", " ")}</span></li><li>Environment: <span class="font-medium">${environment.replace("-", " ")}</span></li></ul></div></div></div><div class="px-6 py-4 bg-gray-900/50 text-right"><button class="export-btn font-sans normal-case" onclick="exportSection('capture-scenario','scenario-outcome')"><i data-lucide="download" class="w-4 h-4"></i> Export Scenario</button></div></div>`;
            lucide.createIcons({ nodes: modalContent.querySelectorAll("[data-lucide]") });
            document.getElementById('modal-overlay').classList.add('visible');
        }

        function showAppendixScenario(animal) {
            const humanState = document.getElementById(`human-state-${animal}`).value;
            const result = scenarioDB.appendix[animal][humanState];
            const resultDiv = document.getElementById(`result-${animal}`);
            resultDiv.innerHTML = `<div class="mt-2 p-3 rounded-lg border" style="border-color:${result.color};background-color:${result.color}20;"><strong class="font-bold" style="color:${result.color};">${result.title}:</strong> <span class="text-gray-300">${result.analysis}</span></div>`;
        }

        function closeModal() { document.getElementById('modal-overlay').classList.remove('visible'); }
        window.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });
        document.getElementById('modal-overlay').addEventListener('click', (e) => { if (e.target.id === 'modal-overlay') closeModal(); });

        function exportSection(elementId, filename) {
            const elementToExport = document.getElementById(elementId);
            const exportButton = elementToExport.querySelector('.export-btn');
            if (exportButton) exportButton.style.display = 'none';
            html2canvas(elementToExport, { backgroundColor: getComputedStyle(document.body).getPropertyValue('--card-bg-color').trim(), scale: 2, useCORS: true, onclone: (doc) => { lucide.createIcons({ nodes: doc.querySelectorAll("[data-lucide]") }); } }).then(canvas => {
                if (exportButton) exportButton.style.display = 'inline-flex';
                const link = document.createElement('a');
                link.download = `${filename}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            }).catch(err => {
                console.error('Export failed:', err);
                if (exportButton) exportButton.style.display = 'inline-flex';
            });
        }
    </script>
</body>
</html>
