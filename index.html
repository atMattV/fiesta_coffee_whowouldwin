<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Interactive Analysis: Gorilla vs. 100 Men</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Inter:wght@400;500&display=swap');
        :root {
            --bg-color: #111827;
            --card-bg-color: #1f2937;
            --border-color: #374151;
            --text-color: #f3f4f6;
            --text-muted-color: #9ca3af;
            --accent-gorilla: #F59E0B;
            --accent-human: #3B82F6;
            --accent-win: #10B981;
            --accent-loss: #EF4444;
            --accent-mixed: #F97316;
        }
        body {
            font-family: 'Inter', sans-serif; /* Fallback font */
            background-color: var(--bg-color);
            color: var(--text-color);
        }
        h1, h2, h3, h4, h5, .primary-btn, .toggle-btn {
             font-family: 'Oswald', sans-serif;
             text-transform: uppercase;
             letter-spacing: 0.05em;
        }
        .section-card {
            background-color: var(--card-bg-color);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
            overflow: hidden;
            transition: box-shadow 0.3s ease;
        }
        .section-card:hover {
             box-shadow: 0 0 15px rgba(0,0,0,0.2);
        }
        .section-header {
            cursor: pointer;
            padding: 1.25rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s ease-in-out;
        }
        .section-header:hover {
            background-color: #374151;
        }
        .section-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.7s ease-in-out, padding 0.5s ease-in-out;
            padding: 0 1.25rem;
            font-family: 'Inter', sans-serif;
        }
        .section-content.expanded {
            max-height: 5000px; /* Large enough for content */
            padding: 1.25rem;
            padding-top: 0.5rem;
        }
        .env-card {
            background-size: cover;
            background-position: center;
            position: relative;
        }
        .env-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.9), rgba(0,0,0,0.4));
            border-radius: 0.5rem;
        }
        .env-card-content {
            position: relative;
            z-index: 10;
        }
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(17, 24, 39, 0.8);
            backdrop-filter: blur(8px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: var(--card-bg-color);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            width: 90%;
            max-width: 650px;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }
        select {
            background-color: var(--border-color);
            border: 1px solid #4b5563;
        }
        .primary-btn {
            background-color: #1E3A8A; /* Darker blue */
            color: white; padding: 0.75rem 1.5rem; border-radius: 0.5rem; font-weight: 700; transition: background-color 0.2s; border: none; cursor: pointer;
        }
        .primary-btn:hover { background-color: #1C3473; }
        .export-btn {
            background-color: var(--accent-win); color: white; padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 500; display: inline-flex; align-items: center; gap: 0.5rem; transition: background-color 0.2s; border: none; cursor: pointer;
        }
        .export-btn:hover { background-color: #059669; }
        .toggle-btn {
            background-color: var(--border-color);
            color: var(--text-color);
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 600;
        }
        .reference-link {
            color: var(--accent-human);
            text-decoration: none;
            transition: color 0.2s;
        }
        .reference-link:hover {
            color: #60A5FA;
            text-decoration: underline;
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">

    <div class="max-w-5xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-5xl font-bold text-white mb-3">Gorilla vs. 100 Men</h1>
            <p class="text-lg text-gray-400 font-sans tracking-normal normal-case">An Advanced Interactive Combat Analysis</p>
        </header>

        <!-- Scenario Builder -->
        <div class="section-card" id="scenario-builder">
            <div class="p-6">
                <h2 class="text-2xl font-bold mb-4 text-center">Create Your Scenario</h2>
                <div class="grid sm:grid-cols-3 gap-4 mb-6 font-sans">
                    <div>
                        <label for="gorilla-state" class="block mb-2 text-sm font-medium text-gray-300 normal-case">Gorilla's State</label>
                        <select id="gorilla-state" class="w-full p-2.5 rounded-lg text-white">
                            <option value="normal">Normal / Defensive</option>
                            <option value="bloodlusted">Bloodlusted / Max Aggression</option>
                        </select>
                    </div>
                    <div>
                        <label for="human-state" class="block mb-2 text-sm font-medium text-gray-300 normal-case">Humans' State</label>
                        <select id="human-state" class="w-full p-2.5 rounded-lg text-white">
                            <option value="fearful">Fearful / Panicked</option>
                            <option value="unco-bloodlusted">Uncoordinated & Bloodlusted</option>
                            <option value="co-bloodlusted">Coordinated & Bloodlusted</option>
                        </select>
                    </div>
                    <div>
                        <label for="environment" class="block mb-2 text-sm font-medium text-gray-300 normal-case">Environment</label>
                        <select id="environment" class="w-full p-2.5 rounded-lg text-white">
                            <option value="open">Open Plain / Arena</option>
                            <option value="forest">Dense Forest / Ruins</option>
                            <option value="confined">Confined Arena (No Escape)</option>
                        </select>
                    </div>
                </div>
                <div class="text-center">
                    <button class="primary-btn" onclick="showScenario()">
                        Analyze Outcome
                    </button>
                </div>
            </div>
        </div>

        <!-- Combatant Profiles Section -->
        <div class="section-card" id="export-profiles">
            <div class="section-header" onclick="toggleSection(this)">
                <div class="flex items-center gap-4"><i data-lucide="users-2"></i><h2 class="text-xl font-semibold">Combatant Profiles</h2></div>
                <button class="toggle-btn">Learn More</button>
            </div>
            <div class="section-content border-t border-gray-700">
                <div class="grid md:grid-cols-2 gap-8 pt-4">
                    <div>
                        <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--accent-gorilla);">Silverback Gorilla</h3>
                        <p class="text-sm text-gray-400 mb-4">A biological engine of immense, explosive power. Adapted for short, brutal confrontations.</p>
                        <div class="space-y-3">
                            <p class="text-sm"><strong class="font-semibold">Strength:</strong> Can lift ~815 kg. Punching force estimated at 1,000-1,200 lbf.</p>
                            <p class="text-sm"><strong class="font-semibold">Weaponry:</strong> Canine teeth with a bite force of ~1,300 PSI. Powerful limbs for bludgeoning and tearing.</p>
                            <p class="text-sm"><strong class="font-semibold">Durability:</strong> Thick skin, dense muscle, and robust skeleton provide excellent protection against blunt force.</p>
                            <p class="text-sm"><strong class="font-semibold">Physiology:</strong> Predominantly fast-twitch muscle fibers for explosive power, leading to lower endurance in prolonged fights.</p>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold mb-4 flex items-center gap-2" style="color: var(--accent-human);">100 Unarmed Men</h3>
                        <p class="text-sm text-gray-400 mb-4">Individually outmatched, their only potential advantages are numbers, coordination, and endurance.</p>
                         <div class="space-y-3">
                            <p class="text-sm"><strong class="font-semibold">Strength:</strong> Drastically lower than the gorilla. Success relies on combined mass, not individual power.</p>
                            <p class="text-sm"><strong class="font-semibold">Weaponry:</strong> None. Restricted to blunt force, grappling, and targeting vulnerable areas (e.g., eyes), all of which are high-risk.</p>
                            <p class="text-sm"><strong class="font-semibold">Durability:</strong> Biologically fragile in comparison. Highly susceptible to catastrophic injury from any gorilla attack.</p>
                            <p class="text-sm"><strong class="font-semibold">Physiology:</strong> Superior endurance due to efficient thermoregulation and slow-twitch muscle fibers. A key advantage if the fight is prolonged.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Environmental Factors Section -->
        <div class="section-card" id="export-environments">
            <div class="section-header" onclick="toggleSection(this)">
                 <div class="flex items-center gap-4"><i data-lucide="mountain-snow"></i><h2 class="text-xl font-semibold">Environmental Factors</h2></div>
                <button class="toggle-btn">Learn More</button>
            </div>
            <div class="section-content border-t border-gray-700">
                 <div class="grid md:grid-cols-3 gap-4 pt-4">
                    <div class="p-4 rounded-lg env-card border border-gray-700" style="background-image: url(https://placehold.co/600x400/8c6d52/FFFFFF?text=);">
                        <div class="env-card-content flex flex-col justify-end h-32">
                            <h4 class="font-bold text-lg mb-2">Open Plain</h4>
                            <p class="text-xs text-gray-300 mb-2"><strong><span style="color: var(--accent-human);">Favors Humans</span> (if coordinated):</strong> Allows for encirclement and swarm tactics.</p>
                        </div>
                    </div>
                    <div class="p-4 rounded-lg env-card border border-gray-700" style="background-image: url(https://placehold.co/600x400/22543d/FFFFFF?text=);">
                         <div class="env-card-content flex flex-col justify-end h-32">
                            <h4 class="font-bold text-lg mb-2">Dense Forest</h4>
                            <p class="text-xs text-gray-300 mb-2"><strong><span style="color: var(--accent-gorilla);">Favors Gorilla:</span></strong> Utilizes climbing, ambush, and cover to negate numbers.</p>
                        </div>
                    </div>
                     <div class="p-4 rounded-lg env-card border border-gray-700" style="background-image: url(https://placehold.co/600x400/4a5568/FFFFFF?text=);">
                         <div class="env-card-content flex flex-col justify-end h-32">
                            <h4 class="font-bold text-lg mb-2">Confined Arena</h4>
                             <p class="text-xs text-gray-300 mb-2"><strong><span style="color: var(--accent-mixed);">Forces Confrontation:</span></strong> No retreat for either side. Heightens pressure.</p>
                        </div>
                    </div>
                 </div>
            </div>
        </div>

        <!-- Appendix Section -->
        <div class="section-card" id="export-appendix">
            <div class="section-header" onclick="toggleSection(this)">
                <div class="flex items-center gap-4"><i data-lucide="paw-print"></i><h2 class="text-xl font-semibold">Appendix: Other Large Animals</h2></div>
                <button class="toggle-btn">Learn More</button>
            </div>
            <div class="section-content border-t border-gray-700">
                <p class="text-gray-400 mb-6 text-sm pt-4">Contextualizing the challenge: How would 100 bloodlusted, coordinated men fare against other megafauna?</p>
                <div class="overflow-x-auto">
                    <table class="w-full text-left text-sm">
                        <thead class="text-xs text-gray-400 uppercase bg-gray-700/50" style="font-family: 'Oswald', sans-serif;">
                            <tr><th class="p-3">Animal</th><th class="p-3 text-center">Predicted Outcome (for Animal)</th><th class="p-3">Reason</th></tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-700"><td class="p-3 font-medium">African Elephant</td><td class="p-3 text-center font-bold text-green-400">>99% Win</td><td class="p-3 text-gray-300">Overwhelming mass and weaponry. Humans cannot inflict meaningful damage.</td></tr>
                            <tr class="border-b border-gray-700"><td class="p-3 font-medium">Grizzly Bear</td><td class="p-3 text-center font-bold text-green-400">>99% Win</td><td class="p-3 text-gray-300">Superior weaponry (claws/bite), ferocity, and durability. High kill rate.</td></tr>
                            <tr class="border-b border-gray-700"><td class="p-3 font-medium">Siberian Tiger / Lion</td><td class="p-3 text-center font-bold text-red-400">>99% Loss</td><td class="p-3 text-gray-300">Lethal, but can be overwhelmed by a coordinated swarm accepting heavy losses.</td></tr>
                            <tr><td class="p-3 font-medium">Moose</td><td class="p-3 text-center font-bold text-red-400">>99% Loss</td><td class="p-3 text-gray-300">Lacks overwhelming offensive tools or aggression to handle a coordinated mob.</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- References Section -->
        <div class="section-card" id="export-references">
            <div class="section-header" onclick="toggleSection(this)">
                <div class="flex items-center gap-4"><i data-lucide="scroll-text"></i><h2 class="text-xl font-semibold">References</h2></div>
                <button class="toggle-btn">Learn More</button>
            </div>
            <div class="section-content border-t border-gray-700 text-xs text-gray-400 space-y-4 pt-4">
                 <div>
                    <h4 class="font-semibold text-gray-200 mb-1">General / Pop Culture Context</h4>
                    <p>[1] Reddit. <a href="https://www.google.com/search?q=reddit+100+men+vs+gorilla" target="_blank" class="reference-link">"100 average men vs. a silverback gorilla."</a><br>[2] Quora. <a href="https://www.google.com/search?q=quora+100+men+vs+gorilla" target="_blank" class="reference-link">"Could 100 men defeat a gorilla?"</a></p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-200 mb-1">Combatant Profiles & Physiology</h4>
                    <p>[3] Roach, N. T., et al. (2013). <a href="https://www.nature.com/articles/nature12138" target="_blank" class="reference-link">"Elastic energy storage in the shoulder and the evolution of high-speed throwing in Homo."</a> *Nature.*<br>[4] National Geographic. <a href="https://www.nationalgeographic.com/animals/mammals/facts/gorillas-group" target="_blank" class="reference-link">"Gorillas."</a><br>[5] Various sources on comparative zoology e.g., <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6102174/" target="_blank" class="reference-link">Bite Force Study</a>.<br>[8] Expert opinions synthesized from sources like <a href="https://www.livescience.com/gorilla-vs-human-fight" target="_blank" class="reference-link">Live Science</a>.<br>[9] <a href="https://www.researchgate.net/publication/232231267_Skeletal_robusticity_and_skeletal_strength_in_primates" target="_blank" class="reference-link">Analysis of biomechanics and durability.</a><br>[16] CDC. <a href="https://www.cdc.gov/nchs/fastats/body-measurements.htm" target="_blank" class="reference-link">"Anthropometric Reference Data for Children and Adults."</a><br>[17] <a href="https://pubmed.ncbi.nlm.nih.gov/20581677/" target="_blank" class="reference-link">Biomechanical studies on human striking power.</a></p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-200 mb-1">Behavior & Psychology</h4>
                    <p>[10] Schaller, G. B. (1963). <a href="https://press.uchicago.edu/ucp/books/book/chicago/M/bo3630262.html" target="_blank" class="reference-link">"*The Mountain Gorilla: Ecology and Behavior.*"</a><br>[11] Fossey, D. (1983). <a href="https://www.google.com/books/edition/Gorillas_in_the_Mist/gYq0DwAAQBAJ" target="_blank" class="reference-link">"*Gorillas in the Mist.*"</a><br>[12] Kogan, N., & Wallach, M. A. (1967). <a href="https://psycnet.apa.org/record/1968-07505-001" target="_blank" class="reference-link">"Risk taking as a function of the situation, the person, and the group."</a><br>[13] Tajfel, H. (1970). <a href="https://www.jstor.org/stable/24927663" target="_blank" class="reference-link">"Experiments in intergroup discrimination."</a> *Scientific American.*<br>[18] Merriam-Webster. <a href="https://www.merriam-webster.com/dictionary/bloodlust" target="_blank" class="reference-link">"Definition of 'bloodlust'."</a><br>[20] Elbert, T., et al. (2009). <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2784157/" target="_blank" class="reference-link">"Trauma-related neuronal reorganization and appetitive aggression..."</a><br>[21] Hecker, T., et al. (2012). <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3526941/" target="_blank" class="reference-link">"Appetitive aggression in former combatants."</a></p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-200 mb-1">Environmental & Tactical Analysis</h4>
                    <p>[23] Bramble, D. M., & Lieberman, D. E. (2004). <a href="https://www.nature.com/articles/nature03052" target="_blank" class="reference-link">"Endurance running and the evolution of Homo."</a> *Nature.*<br>[25] Military Field Manuals e.g., <a href="https://armypubs.army.mil/epubs/DR_pubs/DR_a/pdf/web/ARN18126_ADP%203-90%20FINAL%20WEB.pdf" target="_blank" class="reference-link">US Army ADP 3-90: Offense and Defense</a>.<br>[26] <a href="https://www.rand.org/topics/asymmetric-warfare.html" target="_blank" class="reference-link">Principles of asymmetric warfare.</a></p>
                </div>
                 <div>
                    <h4 class="font-semibold text-gray-200 mb-1">Appendix: Comparative Zoology</h4>
                    <p>[28] <a href="https://www.awf.org/wildlife-conservation" target="_blank" class="reference-link">African Wildlife Foundation.</a> Animal facts.<br>[29] General reference, e.g. <a href="https://animaldiversity.org/" target="_blank" class="reference-link">University of Michigan Museum of Zoology.</a></p>
                </div>
            </div>
        </div>

        <footer class="text-center mt-12 text-gray-500 text-sm font-sans normal-case tracking-normal">
            <p>This analysis is a speculative exercise. No gorillas were harmed in its creation.</p>
        </footer>
    </div>

    <!-- Modal -->
    <div id="modal-overlay" class="modal-overlay">
        <div id="modal-content" class="modal-content">
            <!-- Dynamic content will be injected here -->
        </div>
    </div>

    <script>
        lucide.createIcons();

        function toggleSection(headerElement) {
            const content = headerElement.nextElementSibling;
            const button = headerElement.querySelector('.toggle-btn');
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                button.textContent = 'Learn More';
            } else {
                content.classList.add('expanded');
                button.textContent = 'Collapse';
            }
        }

        const scenarioDB = {
            normal:{"fearful":{"open":{title:"Gorilla Victory",color:"var(--accent-loss)",analysis:"The gorilla's initial threat displays cause mass panic. The human group scatters, cohesion breaks instantly, and they become ineffective. The gorilla neutralizes the immediate threat by routing the opposition."},"forest":{title:"Decisive Gorilla Victory",color:"var(--accent-loss)",analysis:"The gorilla uses the terrain for ambush and intimidation. Fearful humans in a disorienting environment stand no chance. The gorilla can easily evade and pick off stragglers."},"confined":{title:"Gorilla Victory",color:"var(--accent-loss)",analysis:"No escape route amplifies human panic. The gorilla, feeling cornered, becomes highly aggressive. The panicked mob is easily dismantled."}},"unco-bloodlusted":{"open":{title:"Decisive Gorilla Victory",color:"var(--accent-loss)",analysis:"Bloodlust without coordination is suicidal. Sporadic, reckless charges by individuals or small groups are easily dealt with sequentially by the gorilla, leading to a slaughter."},"forest":{title:"Decisive Gorilla Victory",color:"var(--accent-loss)",analysis:"The worst-case scenario for humans. The gorilla's environmental advantage combined with a lack of human strategy leads to a one-sided massacre."},"confined":{title:"Decisive Gorilla Victory",color:"var(--accent-loss)",analysis:"Even in a confined space, uncoordinated attacks are futile. The gorilla systematically destroys attackers until none are left."}},"co-bloodlusted":{"open":{title:"Costly Human Victory",color:"var(--accent-win)",analysis:"This is the humans' best chance. Suppressed fear allows a coordinated swarm. Casualties will be catastrophic, but sustained, overwhelming numbers could eventually exhaust and incapacitate the gorilla."},"forest":{title:"Gorilla Favored / Pyrrhic Victory",color:"var(--accent-mixed)",analysis:"The gorilla's ability to ambush and use cover severely hampers human coordination. While humans might eventually corner it, the cost in lives would be immense, making victory questionable."},"confined":{title:"Costly Human Victory",color:"var(--accent-win)",analysis:"The lack of an escape route forces the confrontation. If human resolve holds, their numbers will inevitably overwhelm the gorilla in a brutal battle of attrition. Expect dozens of fatalities."}}},
            bloodlusted:{"fearful":{"open":{title:"Annihilation",color:"var(--accent-loss)",analysis:"A maximally aggressive gorilla against a terrified, scattering crowd is not a fight; it's a slaughter. The gorilla will inflict maximum casualties without pause."},"forest":{title:"Annihilation",color:"var(--accent-loss)",analysis:"The gorilla becomes a terrifying, unstoppable force in its own element. Humans have no hope of escape or defense."},"confined":{title:"Annihilation",color:"var(--accent-loss)",analysis:"A bloodbath. The humans are trapped with a relentless killing machine. The outcome is swift and total."}},"unco-bloodlusted":{"open":{title:"Decisive Gorilla Victory",color:"var(--accent-loss)",analysis:"A bloodlusted gorilla maximizes its kill rate. Uncoordinated human attacks are even more futile, as the gorilla will not waste a second, resulting in a swift, brutal defeat for the humans."},"forest":{title:"Decisive Gorilla Victory",color:"var(--accent-loss)",analysis:"The gorilla hunts down the uncoordinated attackers with extreme prejudice. Human aggression is meaningless without strategy here."},"confined":{title:"Decisive Gorilla Victory",color:"var(--accent-loss)",analysis:"The arena becomes a killing floor. The gorilla's sustained ferocity completely overwhelms the chaotic human assault."}},"co-bloodlusted":{"open":{title:"Mutual Destruction / Pyrrhic Human Victory",color:"var(--accent-mixed)",analysis:"The ultimate clash. The gorilla's relentless attack will cause staggering casualties from the first second. Humans might win, but the cost could be over half the group. A true 'kamikaze' mission."},"forest":{title:"Gorilla Victory",color:"var(--accent-loss)",analysis:"A bloodlusted gorilla in a forest is nearly unbeatable. It will use terrain to inflict maximum damage while avoiding encirclement. Human coordination is insufficient to overcome this advantage."},"confined":{title:"Costly Human Victory (Extreme)",color:"var(--accent-win)",analysis:"The most brutal scenario. The gorilla fights to the absolute death, inflicting horrific damage. Humans can only win by literally piling bodies on it until it is suffocated or broken. The casualty rate would be astronomical."}}}
        };

        function showScenario() {
            const gorillaState = document.getElementById('gorilla-state').value;
            const humanState = document.getElementById('human-state').value;
            const environment = document.getElementById('environment').value;
            const result = scenarioDB[gorillaState][humanState][environment];
            const modalContent = document.getElementById('modal-content');
            modalContent.innerHTML = `
                <div id="capture-scenario">
                    <div class="p-6">
                        <div class="flex justify-between items-start">
                             <h3 class="text-2xl font-bold mb-4">Scenario Outcome</h3>
                             <button onclick="closeModal()" class="text-gray-400 hover:text-white text-3xl leading-none">&times;</button>
                        </div>
                        <div class="mb-4 p-4 rounded-lg border" style="border-color: ${result.color}; background-color: ${result.color}20;">
                            <h4 class="text-xl font-bold" style="color: ${result.color};">${result.title}</h4>
                        </div>
                        <div class="space-y-4 text-gray-300 font-sans tracking-normal normal-case">
                             <div>
                                <h5 class="font-semibold text-white mb-1 font-family-oswald uppercase">Analysis:</h5>
                                <p class="text-sm">${result.analysis}</p>
                            </div>
                            <div>
                                <h5 class="font-semibold text-white mb-1 font-family-oswald uppercase">Key Factors:</h5>
                                <ul class="list-disc list-inside text-sm space-y-1">
                                    <li>Gorilla State: <span class="font-medium">${gorillaState.replace("-", " ")}</span></li>
                                    <li>Human State: <span class="font-medium">${humanState.replace("-", " ")}</span></li>
                                    <li>Environment: <span class="font-medium">${environment.replace("-", " ")}</span></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="px-6 py-4 bg-gray-900/50 text-right">
                        <button class="export-btn font-sans normal-case" onclick="exportSection('capture-scenario', 'scenario-outcome')">
                            <i data-lucide="download" class="w-4 h-4"></i> Export Scenario
                        </button>
                    </div>
                </div>
            `;
             lucide.createIcons({nodes: modalContent.querySelectorAll("[data-lucide]")});
            document.getElementById('modal-overlay').classList.add('visible');
        }

        function closeModal() { document.getElementById('modal-overlay').classList.remove('visible'); }

        window.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && document.getElementById('modal-overlay').classList.contains('visible')) {
                closeModal();
            }
        });
        document.getElementById('modal-overlay').addEventListener('click', (e) => {
            if (e.target.id === 'modal-overlay') { closeModal(); }
        });

        function exportSection(elementId, filename) {
            const elementToExport = document.getElementById(elementId);
            const exportButton = elementToExport.querySelector('.export-btn');
            if(exportButton) exportButton.style.display = 'none';
            html2canvas(elementToExport, {
                backgroundColor: getComputedStyle(document.body).getPropertyValue('--card-bg-color').trim(),
                scale: 2,
                useCORS: true,
                 onclone: (doc) => { lucide.createIcons({nodes: doc.querySelectorAll("[data-lucide]")}); }
            }).then(canvas => {
                if(exportButton) exportButton.style.display = 'inline-flex';
                const link = document.createElement('a');
                link.download = `${filename}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            }).catch(err => {
                console.error('Export failed:', err);
                if(exportButton) exportButton.style.display = 'inline-flex';
            });
        }
    </script>
</body>
</html>
